import t,{useRef as e,useCallback as r}from"react";import{usePortal as n}from"react-tiny-portal";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
function s(t){return!0==(null!=(e=t)&&"object"==typeof e&&!1===Array.isArray(e))&&"[object Object]"===Object.prototype.toString.call(t);var e}function f(t){var e,r;return!1!==s(t)&&("function"==typeof(e=t.constructor)&&(!1!==s(r=e.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))}var l=/[A-Z]/g,p=/^ms-/,y={};function m(t){return"-"+t.toLowerCase()}var d=function(t){return t&&Array.isArray(t)},v=function(t){return f(t)||d(t)},b=function(t,e){if(!t||t&&""===t.trim()||!f(e))return null;var r=Object.keys(e).map((function(t){return"".concat(function(t){if(y.hasOwnProperty(t))return y[t];var e=t.replace(l,m);return y[t]=p.test(e)?"-"+e:e}(t),": ").concat(e[t],";")}));return"".concat(t,"{").concat(r.join(""),"}")},g=function(t,e){var r=document.querySelector("style[".concat(t,'="').concat(e,'"]'));if(r)return r;var n=document.createElement("style");return n.type="text/css",n.setAttribute(t,e),document.head.appendChild(n),n},h=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t);var r={styleDataName:"data-keyframes"};this.keyframes={},this.options=u({},r,{},e)}var e,r,n;return e=t,(r=[{key:"createKeyframesString",value:function(t,e){if(!t||"string"!=typeof t||!v(e))return"";var r=d(e)?[]:{};return Object.keys(e).forEach((function(t){r[t]=e[t]})),function(t,e,r){if(!t||t&&""===t.trim()||!v(r))return null;var n=Object.keys(r).map((function(t){var e=r[t],n=t;if("number"==typeof t||/^\d+$/.test(t)){var a=r.length-1;n=0===t?"0%":t===a?"100%":"".concat(parseInt(t,10)/a*100,"%")}return b(n,e)}));return"@".concat(e," ").concat(t,"{").concat(n.join(""),"}")}(t,"keyframes",r)}},{key:"register",value:function(t,e){this.unregister(t);var r=this.options.styleDataName,n=this.createKeyframesString(t,e);if(""!==n){var a=g(r,t);null!=a&&(a.innerHTML=n,this.keyframes[t]=a)}}},{key:"unregister",value:function(t){if(this.contains(t)){var e=this.keyframes[t];e.parentNode.removeChild(e),delete this.keyframes[t]}}},{key:"unregisterAll",value:function(){var t=this;Object.keys(this.keyframes).forEach((function(e){return t.unregister(e)}))}},{key:"contains",value:function(t){return this.keyframes.hasOwnProperty(t)}}])&&o(e.prototype,r),n&&o(e,n),t}());export default function(){var a=n(),o=a.Portal,i=a.open,c=a.close,u=a.isOpen,s=e(null),f=e(null),l=r((function(t){if(s.current){var e=s.current;return f.current=function(t,e){var r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),a=(r.left+r.right)/2-(n.left+n.right)/2,o=(r.top+r.bottom)/2-(n.top+n.bottom)/2;h.register("portalFadeIn",{"0%":{transform:"translate(".concat(a,"px, ").concat(o,"px) scale(0.1, 0.1) "),opacity:0},"100%":{opacity:1}}),h.register("portalFadeOut",{"0%":{opacity:1},"100%":{transform:"translate(".concat(a,"px, ").concat(o,"px) scale3d(0.01, 0.01, 0.01)"),opacity:0}});var i=g("data-portal-animation","portal-animation");return i&&(i.innerHTML=".portalFade {\n        animation: portalFadeIn 1s ease-out;\n    }"),function(){var t=g("data-portal-animation","portal-animation");t&&(t.innerHTML=".portalFade {\n          animation: portalFadeOut 1s ease-out;\n      }")}}(e,t.target),i(t)}return null}),[i]),p=r((function(t){if(f.current){if(f.current(),t&&t.persist&&"function"==typeof t.persist&&t.persist(),s.current){var e=s.current;e.addEventListener("animationend",(function r(){e.removeEventListener("animationend",r),c(t)}))}}else c(t)}),[c]),y=r((function(e){return e.bindTo?s.current=document.getElementById(e.bindTo):s.current=document.body,t.createElement(o,e,t.createElement("div",{tabIndex:-1,style:{position:"fixed",top:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)"},className:"portalFade"},e.children))}));return Object.assign({},{Modal:y,isOpen:u,open:l,close:p})}
